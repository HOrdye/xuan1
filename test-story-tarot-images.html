<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>故事塔罗牌图片测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .card-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 2px solid transparent;
        }
        .card-image.loaded {
            border-color: #4CAF50;
        }
        .card-image.error {
            border-color: #f44336;
            background: #ffebee;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #d32f2f;
            font-weight: bold;
        }
        .card-title {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 1.1em;
        }
        .card-subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        .card-path {
            font-size: 0.8em;
            color: rgba(255, 255, 255, 0.6);
            word-break: break-all;
        }
        .section-title {
            font-size: 1.5em;
            margin: 30px 0 20px 0;
            text-align: center;
            color: #FFD700;
        }
        .error-list {
            background: rgba(244, 67, 54, 0.1);
            border: 1px solid rgba(244, 67, 54, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        .error-item {
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(244, 67, 54, 0.2);
            border-radius: 5px;
        }
        .success {
            color: #4CAF50;
        }
        .error {
            color: #f44336;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎴 故事塔罗牌图片加载测试</h1>
            <p>测试 storyTarotData.ts 中的图片路径是否正确</p>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalCards">0</div>
                <div>总卡牌数</div>
            </div>
            <div class="stat-card">
                <div class="stat-number success" id="loadedCount">0</div>
                <div>加载成功</div>
            </div>
            <div class="stat-card">
                <div class="stat-number error" id="errorCount">0</div>
                <div>加载失败</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="successRate">0%</div>
                <div>成功率</div>
            </div>
        </div>

        <div class="section-title">🃏 大阿尔卡纳 (Major Arcana)</div>
        <div class="cards-grid" id="majorCards"></div>

        <div class="section-title">🎴 小阿尔卡纳 - 权杖 (Wands)</div>
        <div class="cards-grid" id="wandsCards"></div>

        <div class="section-title">🎴 小阿尔卡纳 - 圣杯 (Cups)</div>
        <div class="cards-grid" id="cupsCards"></div>

        <div class="section-title">🎴 小阿尔卡纳 - 宝剑 (Swords)</div>
        <div class="cards-grid" id="swordsCards"></div>

        <div class="section-title">🎴 小阿尔卡纳 - 星币 (Pentacles)</div>
        <div class="cards-grid" id="pentaclesCards"></div>

        <div id="errorSection" style="display: none;">
            <div class="section-title error">❌ 加载失败的卡牌</div>
            <div class="error-list" id="errorList"></div>
        </div>
    </div>

    <script type="module">
        // 导入故事塔罗牌数据
        import { storyTarotDeck } from './src/features/tarot/utils/storyTarotData.ts';

        let loadedCount = 0;
        let errorCount = 0;
        const errorCards = [];

        // 更新统计信息
        function updateStats() {
            document.getElementById('totalCards').textContent = storyTarotDeck.length;
            document.getElementById('loadedCount').textContent = loadedCount;
            document.getElementById('errorCount').textContent = errorCount;
            
            const successRate = storyTarotDeck.length > 0 ? 
                Math.round((loadedCount / storyTarotDeck.length) * 100) : 0;
            document.getElementById('successRate').textContent = successRate + '%';
        }

        // 创建卡牌元素
        function createCardElement(card) {
            const cardDiv = document.createElement('div');
            cardDiv.className = 'card';
            
            const img = document.createElement('img');
            img.className = 'card-image';
            img.src = card.imageUrl;
            img.alt = card.chineseName;
            
            img.onload = function() {
                this.classList.add('loaded');
                loadedCount++;
                updateStats();
            };
            
            img.onerror = function() {
                this.classList.add('error');
                this.style.display = 'flex';
                this.textContent = '图片加载失败';
                errorCount++;
                errorCards.push({
                    id: card.id,
                    name: card.chineseName,
                    path: card.imageUrl
                });
                updateStats();
                showErrors();
            };
            
            cardDiv.innerHTML = `
                <div class="card-title">${card.chineseName}</div>
                <div class="card-subtitle">${card.name}</div>
                <div class="card-path">${card.imageUrl}</div>
            `;
            
            cardDiv.insertBefore(img, cardDiv.firstChild);
            return cardDiv;
        }

        // 显示错误信息
        function showErrors() {
            if (errorCards.length > 0) {
                document.getElementById('errorSection').style.display = 'block';
                const errorList = document.getElementById('errorList');
                errorList.innerHTML = errorCards.map(card => `
                    <div class="error-item">
                        <strong>ID ${card.id}: ${card.name}</strong><br>
                        路径: ${card.path}
                    </div>
                `).join('');
            }
        }

        // 按类别分组卡牌
        function groupCards() {
            const groups = {
                major: [],
                wands: [],
                cups: [],
                swords: [],
                pentacles: []
            };

            storyTarotDeck.forEach(card => {
                if (card.category === 'major') {
                    groups.major.push(card);
                } else if (card.suit) {
                    groups[card.suit].push(card);
                }
            });

            return groups;
        }

        // 渲染卡牌
        function renderCards() {
            const groups = groupCards();
            
            // 渲染各个分组
            Object.keys(groups).forEach(groupName => {
                const container = document.getElementById(groupName + 'Cards');
                if (container) {
                    groups[groupName]
                        .sort((a, b) => a.id - b.id)
                        .forEach(card => {
                            container.appendChild(createCardElement(card));
                        });
                }
            });
        }

        // 初始化
        console.log('故事塔罗牌数据:', storyTarotDeck);
        console.log('总卡牌数:', storyTarotDeck.length);
        
        updateStats();
        renderCards();

        // 5秒后显示最终统计
        setTimeout(() => {
            console.log('=== 最终统计 ===');
            console.log('总卡牌数:', storyTarotDeck.length);
            console.log('加载成功:', loadedCount);
            console.log('加载失败:', errorCount);
            console.log('成功率:', Math.round((loadedCount / storyTarotDeck.length) * 100) + '%');
            
            if (errorCards.length > 0) {
                console.log('失败的卡牌:', errorCards);
            } else {
                console.log('🎉 所有图片都加载成功！');
            }
        }, 5000);
    </script>
</body>
</html> 