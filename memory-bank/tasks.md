# 天玄Web项目任务跟踪

## 项目概述
天玄Web是一个专为90后、00后年轻人打造的玄学决策助手网页应用。该项目旨在通过现代化的网页技术，为用户提供轻松有趣的玄学体验平台，帮助他们在决策过程中获得启发和指引。

## 项目当前状态

### 已完成功能 ✅
1. **六十四卦占卜系统**
   - 易经铜钱占卜法
   - 梅花易数法
   - 随机起卦法
   - 六十四卦浏览器

2. **玄选两难系统**
   - 两个选项分析对比
   - 基于卦象的决策建议

3. **功能入口优化**
   - 导航系统（包含易经占卜下拉菜单）
   - 主页和各功能页面的占卜方法入口
   - 用户发现和访问功能的路径优化

4. **LLM API集成**
   - LLM服务配置和调用
   - 多种API提供商支持
   - 错误处理和降级策略

5. **今日运势模块**
   - 完善运势生成算法
   - 新的FortuneCard组件设计
   - 分项运势显示（事业、财运、感情、健康）
   - 幸运元素展示（数字、颜色、方位）
   - AI个性化分析集成
   - 用户界面优化
   - AI运势生成功能（待扩展useFortune）

### 进行中功能 🔄

#### 笅杯占卜功能
- [x] 基础页面结构创建
- [x] 基础投掷动画实现
- [x] 基础结果展示组件
- [ ] 笅杯动画优化：增加自然的物理效果和落地视觉反馈
- [ ] 结果界面优化：使结果展示更富有仪式感和启发性
- [ ] 添加动画过渡效果：使整体体验更流畅
- [ ] 增加更详细的结果解读内容
- [ ] 优化移动端体验
- [ ] 添加结果分享功能

#### 今日运势模块
- [x] 基础页面结构创建 
- [x] 生日输入表单实现
- [x] 基础运势卡片组件
- [ ] 完善运势生成算法，加强个性化元素
- [ ] 添加运势分项卡片（财运、事业运、健康运等）
- [ ] 实现宜忌事项卡片组件
- [ ] 添加幸运色、幸运数字等元素
- [ ] 优化UI界面和视觉效果
- [ ] 添加运势保存和分享功能

### 待开发功能（按优先级排序）

#### 第二阶段：个性化体验
1. **玄学画像系统**
   - [ ] 用户基础信息采集
   - [ ] 本命星盘/八字简析算法
   - [ ] 能量趋势分析模块
   - [ ] 专属守护符号生成器

2. **DIY开运潮物**
   - [ ] 玄学元素库构建
   - [ ] 组合规则设计
   - [ ] 电子御守生成器
   - [ ] 壁纸定制功能

3. **数据持久化**
   - [ ] 用户数据存储系统
   - [ ] 历史记录功能
   - [ ] 收藏功能实现

#### 第三阶段：AI赋能
1. **AI解梦师/智能塔罗解读**
   - [ ] 塔罗牌组件开发
   - [ ] DeepSeek API集成
   - [ ] 提示词优化
   - [ ] 心情打卡系统

2. **后端服务整合**
   - [ ] Supabase整合
   - [ ] 用户认证系统
   - [ ] 云函数开发

3. **智能匹配系统（预研）**
   - [ ] 匹配算法研究
   - [ ] 隐私保护方案设计

#### 第四阶段：游戏化互动
1. **玄学知识大挑战**
   - [ ] 题库建设
   - [ ] 关卡设计
   - [ ] 游戏化界面开发

2. **心情塔罗打卡**
   - [ ] 打卡界面开发
   - [ ] 成就系统设计
   - [ ] 奖励机制实现

3. **玄境漂流瓶/心愿祈福墙**
   - [ ] 社区互动功能
   - [ ] 内容审核系统
   - [ ] 分享功能

## 技术债务和问题
- [ ] 检查和更新依赖版本
- [ ] 优化项目结构和代码组织
- [ ] 完善错误处理和日志系统
- [ ] 提升应用性能和加载速度
- [ ] 增强跨浏览器和设备兼容性

## 下一步优先任务
1. **笅杯占卜功能完善**
   - [ ] 优化动画效果，增强物理真实感
   - [ ] 丰富结果解读内容
   - [ ] 改进UI/UX体验

2. **今日运势模块完善**
   - [ ] 完善运势生成算法
   - [ ] 实现宜忌事项卡片
   - [ ] 优化视觉设计

3. **整体体验提升**
   - [ ] 统一设计语言和交互模式
   - [ ] 优化移动端体验
   - [ ] 增加动画和过渡效果

## 进度更新
- [2024-06-10] 笅杯占卜功能基础版本已实现，包含简单投掷动画和结果显示
- [2024-06-10] 今日运势模块基础版本已实现，包含生日输入和基础运势展示
- [2024-06-10] 下一步重点是优化这两个功能的用户体验和内容丰富度

## 详细开发计划 (Detailed Development Plan) - 复杂度级别 3 (Complexity Level 3)

### 优先任务1: 完善笅杯占卜功能 (Enhance JiaoBei Divination Feature)

#### 1. 需求分析 (Requirements Analysis)
*   **用户故事**: 用户希望通过更真实、有仪式感的笅杯投掷体验获得清晰的占卜结果，并理解其含义。
*   **核心优化点**:
    *   改进投掷动画，使其更具物理真实感和随机性。
    *   优化结果展示，使其更直观、更有启发性。
    *   丰富结果解读内容，使其对用户更有指导意义。
    *   改进整体UI/UX，提升用户体验。

#### 2. 优化任务 (Enhancement Tasks)
*   **动画优化**:
    *   [ ] 使用Anime.js高级特性实现更真实的物理投掷效果
    *   [ ] 添加杯子旋转和碰撞效果
    *   [ ] 改进杯子落地的视觉和声音反馈
*   **结果展示**:
    *   [ ] 设计更直观的结果图示
    *   [ ] 优化结果切换动画
    *   [ ] 增加结果的情感反馈（颜色、图标等）
*   **内容丰富**:
    *   [ ] 扩充解读文本库
    *   [ ] 针对不同问题类型提供差异化解读
    *   [ ] 添加积极引导的行动建议
*   **用户体验**:
    *   [ ] 添加简短的使用引导
    *   [ ] 优化移动端适配
    *   [ ] 实现结果分享功能

### 优先任务2: 完善今日运势模块 (Enhance Fortune Module)

#### 1. 需求分析 (Requirements Analysis)
*   **用户故事**: 用户希望获得个性化的、详细的每日运势信息，包括各方面运势细节和实用建议。
*   **核心优化点**:
    *   完善运势生成算法，尤其是结合生日信息的个性化内容。
    *   增加运势分项展示，如事业运、财运、健康运等。
    *   添加宜忌事项和行动建议。
    *   优化整体视觉设计。

#### 2. 优化任务 (Enhancement Tasks)
*   **算法完善**:
    *   [ ] 优化基于生日的运势计算逻辑
    *   [ ] 增加与日期、星座、生肖等因素的关联
    *   [ ] 扩充运势描述和建议库
*   **UI组件开发**:
    *   [ ] 设计并实现运势分项卡片
    *   [ ] 设计并实现宜忌事项卡片
    *   [ ] 添加幸运色、幸运数字、方位等元素展示
*   **内容丰富**:
    *   [ ] 扩充运势描述文本库
    *   [ ] 增加更实用的行动建议
    *   [ ] 添加积极正面的心理暗示内容
*   **用户体验**:
    *   [ ] 优化生日选择体验
    *   [ ] 添加运势历史记录功能
    *   [ ] 实现运势分享功能

#### 3. 组件影响 (Components Affected)
*   **新组件**:
    *   `src/features/fortune/views/FortunePage.vue` (主页面)
    *   `src/features/fortune/components/BirthdayInputForm.vue` (生日输入组件)
    *   `src/features/fortune/components/FortuneDisplay.vue` (运势展示组件)
    *   `src/composables/useFortune.ts` (运势逻辑相关)
    *   `src/features/fortune/services/fortuneService.ts` (运势算法与数据处理)
*   **修改组件**:
    *   `src/router/index.ts` (添加新路由)
    *   `src/components/AppNavbar.vue` 或其他导航组件 (添加入口)
    *   `src/store/userStore.ts` (可能需要存储用户生日信息)

#### 4. 架构考虑 (Architecture Considerations)
*   **运势生成算法**:
    *   可以结合多种因素：日期（干支纪日）、用户生日（计算生肖、星座，甚至简单的八字元素）、随机数。
    *   算法不宜过于复杂以保证快速生成，但需保证每日内容有变化。
    *   解读库：预设多种运势描述、开运建议、避坑提示，通过算法匹配组合。
*   **数据存储**:
    *   用户生日信息（如果用户选择提供并希望保存）可以使用 Pinia store + `pinia-plugin-persistedstate` 进行本地持久化。未来可考虑后端存储。
*   **内容管理**: 运势解读文本、幸运元素等可以存储在JSON文件中，方便管理和更新。

#### 5. 实现策略 (Implementation Strategy)
1.  **阶段1: 核心算法与数据结构设计 (Creative & Implementation)**
    *   设计运势生成算法的基础逻辑 (`fortuneService.ts`)。
    *   定义运势结果的数据结构。
    *   创建初步的运势解读文本库 (JSON)。
2.  **阶段2: UI 开发与用户输入 (Implementation)**
    *   开发 `FortunePage.vue` 页面布局。
    *   开发 `BirthdayInputForm.vue` 用于采集和验证用户生日。
    *   开发 `FortuneDisplay.vue` 以美观地展示运势结果。
3.  **阶段3: 整合、测试与内容丰富 (Implementation & Content)**
    *   整合生日输入、算法调用和结果展示。
    *   添加路由和导航入口。
    *   进行功能测试和用户体验测试。
    *   扩展和优化运势解读内容库。

#### 6. 详细步骤 (Detailed Steps)
*   **算法与数据设计 (Creative Phase for algorithm)**:
    *   [ ] 步骤1.1: 研究并确定运势生成算法的参数和逻辑 (产品设计, 前端开发, 可能需要玄学顾问)。参考 `activeContext.md` -> "设计基本运势生成算法"。
    *   [ ] 步骤1.2: 设计运势解读库的数据结构 (e.g., 包含运势描述、幸运指数、颜色、数字、宜忌等)。(前端开发)
    *   [ ] 步骤1.3: 初始化一部分解读库内容。(内容创作者)
    *   [ ] 步骤1.4: 实现 `fortuneService.ts` 中的核心算法，根据输入（日期、生日）生成运势对象。(前端开发)
*   **UI与用户交互**:
    *   [ ] 步骤2.1: 设计 `FortunePage.vue` 的整体布局和交互流程。(产品设计, UI/UX)
    *   [ ] 步骤2.2: 开发 `BirthdayInputForm.vue` 组件，支持日期选择和本地存储 (可选)。(前端开发) 参考 `activeContext.md` -> "开发用户生日信息采集表单"。
    *   [ ] 步骤2.3: 开发 `FortuneDisplay.vue` 组件，用于展示格式化的运势结果。(前端开发)
    *   [ ] 步骤2.4: 开发 `FortunePage.vue`，集成生日输入、调用运势服务、展示结果。(前端开发)
    *   [ ] 步骤2.5: 在 `src/router/index.ts` 中添加 `/fortune` 路由。(前端开发)
    *   [ ] 步骤2.6: 在导航栏添加"今日运势"入口。(前端开发)
*   **内容与测试**:
    *   [ ] 步骤3.1: 丰富和迭代运势解读库内容，确保多样性和趣味性。(内容创作者)
    *   [ ] 步骤3.2: 测试不同日期和生日输入的运势生成结果。(前端开发, QA, 产品设计)
    *   [ ] 步骤3.3: 测试UI兼容性和用户体验。(前端开发, QA)

#### 7. 依赖 (Dependencies)
*   日期处理库 (e.g., `date-fns` or built-in `Date` object, `@vueuse/core` for date utilities).
*   项目基础技术栈。

#### 8. 挑战与缓解 (Challenges & Mitigations)
*   **挑战1**: 运势算法既要有趣又要避免迷信色彩，保持积极引导。
    *   **缓解**: 算法设计侧重于提供积极心理暗示和趣味性建议，而非绝对性预测。内容审核严格把关。(`activeContext.md` 已提及)
*   **挑战2**: 保证每日运势内容的多样性，避免重复。
    *   **缓解**: 算法中引入足够的随机因素和组合逻辑，定期更新和扩充解读库。(`progress.md` 已提及)
*   **挑战3**: 用户生日信息的隐私和安全。
    *   **缓解**: 明确告知用户数据用途，仅本地存储（如果用户同意），不强制要求输入。如需后端存储，则需加强安全措施。

#### 9. 创意阶段组件 (Creative Phase Components)
*   **运势生成算法设计 (`fortuneService.ts`)**: 需要创意地结合玄学元素、日期因素和随机性。
*   **运势解读内容**: 需要大量有创意的、吸引人的文案。
*   **UI/UX 设计 (`FortunePage.vue`, `FortuneDisplay.vue`)**: 需要设计吸引人的视觉呈现方式。

---
### 优先任务3: 增强用户界面的互动性和视觉效果 (Enhance UI interactivity and visual effects)

*(此任务较为宽泛，可以分解为针对特定功能或全局的改进。在本次计划中，可以先列为一般性目标，并在上述两个主要功能开发中融入此目标。)*

#### 1. 需求分析 (Requirements Analysis)
*   提升应用整体的视觉吸引力和用户操作的愉悦感。
*   应用更平滑的过渡动画、更有趣的微交互。

#### 2. 组件影响 (Components Affected)
*   可能影响多个现有组件和新组件。
*   `App.vue` (全局过渡)
*   各类交互组件 (按钮、表单、卡片等)
*   `assets/css/tailwind.css` or custom CSS files.

#### 3. 实现策略 (Implementation Strategy)
*   在开发新功能（笅杯、今日运势）时，特别注重动画和交互细节。
*   梳理现有页面，找出可优化交互和视觉效果的点。
*   使用 Anime.js 或 CSS 动画/过渡实现。

#### 4. 详细步骤 (Detailed Steps) (示例)
*   [ ] 为页面切换添加更精致的过渡动画。
*   [ ] 为按钮、卡片等元素添加悬停 (hover) 和点击 (click) 的微交互效果。
*   [ ] 优化表单输入的反馈体验。
*   [ ] 确保所有动画在移动端表现良好。

#### 5. 创意阶段组件 (Creative Phase Components)
*   所有涉及视觉和交互增强的部分都具有创意性。

---
## 计划更新说明
此详细计划将作为 `tasks.md` 的补充或更新部分，用于指导下一阶段的开发工作。各任务的勾选状态将根据实际开发进度进行更新。 

## 当前任务状态 (2024-12-27)

### ✅ 已完成功能
1. **六十四卦占卜系统** (100% 完成)
   - 铜钱法起卦
   - 梅花易数起卦
   - 随机起卦功能
   - 卦象解读和展示

2. **玄选两难系统** (100% 完成)
   - 两难选择界面
   - 随机决策功能
   - 结果展示

3. **功能入口优化** (100% 完成)
   - 主页面布局优化
   - 导航菜单完善

4. **LLM API集成** (100% 完成)
   - LLM服务配置和调用
   - 多种API提供商支持
   - 错误处理和降级策略

5. **今日运势模块** (85% 完成) ⭐ **刚完成**
   - ✅ 完善运势生成算法
   - ✅ 新的FortuneCard组件设计
   - ✅ 分项运势显示（事业、财运、感情、健康）
   - ✅ 幸运元素展示（数字、颜色、方位）
   - ✅ AI个性化分析集成
   - ✅ 用户界面优化
   - 🔄 AI运势生成功能（待扩展useFortune）

### 🔄 进行中功能
1. **笅杯占卜功能** (45% 完成)
   - 基础UI界面
   - 待完善：投掷动画、结果解读

2. **今日运势模块** (85% 完成)
   - 待完善：useFortune扩展以支持AI选项

### 📋 待开发功能 (按优先级排序)
1. **宜忌事项功能** (高优先级)
   - 每日宜做和忌做的事情
   - 基于运势算法生成

2. **用户设置系统** (中优先级)
   - LLM API配置界面
   - 个人信息管理

3. **历史记录功能** (中优先级)
   - 占卜历史
   - 运势历史

4. **分享功能** (低优先级)
   - 结果分享到社交媒体
   - 截图分享

## 技术债务和优化
- [ ] 运势生成器类型定义优化
- [ ] useFortune composable扩展以支持AI功能
- [ ] 性能优化和代码重构
- [ ] 移动端适配优化

## 最新更新摘要 (2024-12-27)
**运势生成算法完善**：
- 重新设计了FortuneResult类型系统
- 创建了全新的FortuneCard组件，支持：
  - 分项运势评分（事业、财运、感情、健康）
  - 星级评分显示
  - 幸运元素展示（数字、颜色、方位）
  - AI个性化分析内容
  - 个性化建议展示
- 更新运势页面UI，增加了：
  - 性别选择
  - 问题咨询输入
  - 快速生成 vs AI智能分析两种模式
  - 更好的加载状态和错误处理
- LLM集成优化，支持运势AI分析 